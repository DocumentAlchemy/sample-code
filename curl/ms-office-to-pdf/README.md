## Convert Microsoft Office Documents to PDF from the Command line

This directory contains a simple example of using the DocumentAlchemy API to
convert a Microsoft Office document (Word, Excel, PowerPoint) into PDF via curl.

### Basics

The PDF document can be generated by a simple curl command. For example:

```bash
curl -H "Authorization: da.key=$API_KEY" \
     -X POST \
     --form "document=@$SOURCE" \
      https://documentalchemy.com/api/v1/document/-/rendition/pdf \
     -o "$DEST"
```

where:

 * `$API_KEY` is replaced by your DocumentAlchemy API key (available at
   <https://documentalchemy.com/my-keys>).

 * `$SOURCE` is the MS Office (.docx, .pptx, .xlsx, etc.) file
   to be converted.

 * `$DEST` is the name of the file to save the PDF document to.

For example, if your API key value is `HbblCNv7gLN2pasWFK44`, the command:

```bash
curl -H "Authorization: da.key=HbblCNv7gLN2pasWFK44" \
     -X POST \
     --form "document=@MyWordDoc.docx" \
      https://documentalchemy.com/api/v1/document/-/rendition/pdf \
     -o MyWordDoc.pdf
```

will convert the MS Word file `MyWordDoc.docx` into a PDF file, saving it to
`MyWordDoc.pdf`.

The exact same syntax works for many types of input document, including older
Word documents (.doc), Microsoft PowerPoint (.ppt, .pptx, .ppsx), and Microsoft
Excel (.xls, .xlsx).

### The Script

The `ms-office-to-pdf.sh` script encapsulates the curl command above with some
basic command line support.

For help, you may execute:

```bash
ms-office-to-pdf.sh --help
```

The general form of the the command is:

```bash
[DA_API_KEY=<API-KEY>] ms-office-to-pdf.sh <OFFICE-DOC> [<PDF-DOC>]
```

where:

 * `<API-KEY>` is replaced by your DocumentAlchemy API key (available at
   <https://documentalchemy.com/my-keys>).

 * `<OFFICE-DOC>` is the MS Office document to convert.

 * `<PDF-DOC>` is the (optional) name of the file to save the PDF to.

For example, if your API key value is `HbblCNv7gLN2pasWFK44`, the command:

```bash
DA_API_KEY=HbblCNv7gLN2pasWFK44 ms-office-to-pdf.sh MyPowerPoint.pptx
```

will create a file (named `document.df`) that contains a PDF representation of
the `MyPowerPoint.pptx` PowerPoint presentation.


Note that you can also `export` the `DA_API_KEY` value as an environment
variable, or edit the `ms-office-to-pdf.sh` script to set your API key as the
default.

See the comments within the file itself for more information about how the
script works.
